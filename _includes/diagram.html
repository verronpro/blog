{%- assign t = include.type | downcase -%}
{%- comment -%}
Usage patterns:

1) Mermaid with captured code
{% capture d %}
graph TD
  A[Start] --> B{Choice}
  B -->|Yes| C[Do]
  B -->|No| D[Skip]
{% endcapture %}
{% include diagram.html type="mermaid" title="Flow" code=d %}

2) PlantUML / Graphviz via Kroki (client-side): same pattern
{% capture d %}
@startuml
Alice -> Bob: Hello
@enduml
{% endcapture %}
{% include diagram.html type="plantuml" title="Seq" code=d %}

This include emits a two-column layout with source code and a render target.
Rendering is performed client-side via Mermaid or Kroki, initialized in the default layout.
{%- endcomment -%}

{%- assign lang = t -%}
{%- if t == 'graphviz' -%}
  {%- assign lang = 'dot' -%}
{%- endif -%}

<figure class="diagram" data-diagram-type="{{ t }}" aria-label="{{ include.title | default: 'Diagram' }}">
  {%- if include.title -%}
    <figcaption class="diagram-title">{{ include.title }}</figcaption>
  {%- endif -%}
  <div class="diagram-grid">
    <div class="diagram-source">
      <pre><code class="language-{{ lang }}">{{ include.code | strip }}</code></pre>
    </div>
    <div class="diagram-render" role="img" aria-label="{{ include.title | default: 'Rendered diagram' }}">
      <!-- client-side renderer will populate here -->
    </div>
  </div>
</figure>
